(()=>{"use strict";const e=window.wp.hooks,t=window.wp.compose,o=window.wp.element,a=window.wp.blockEditor,l=window.wp.components,c=window.wp.i18n;console.log("Drinks Plugin: Block editor integration loaded"),(0,e.addFilter)("editor.BlockEdit","drinks-plugin/with-cocktail-controls",(0,t.createHigherOrderComponent)(e=>t=>{if("core/image"!==t.name)return(0,o.createElement)(e,t);const{attributes:i,setAttributes:r}=t,{cocktailCarousel:n=!1,cocktailPopOut:s=!0}=i;return(0,o.createElement)(o.Fragment,{},(0,o.createElement)(e,t),(0,o.createElement)(a.InspectorControls,{},(0,o.createElement)(l.PanelBody,{title:(0,c.__)("Drinks Plugin Settings","drinks-plugin"),initialOpen:!1},(0,o.createElement)(l.PanelRow,{},(0,o.createElement)(l.ToggleControl,{label:(0,c.__)("Carousel","drinks-plugin"),help:(0,c.__)("Enable carousel functionality for this image","drinks-plugin"),checked:n,onChange:e=>{r(e?s?{cocktailCarousel:!0,cocktailPopOut:!1}:{cocktailCarousel:!0}:{cocktailCarousel:!1})}})),(0,o.createElement)(l.PanelRow,{},(0,o.createElement)(l.ToggleControl,{label:(0,c.__)("Pop Out","drinks-plugin"),help:(0,c.__)("Enable core lightbox functionality","drinks-plugin"),checked:s,onChange:e=>{r(e?n?{cocktailPopOut:!0,cocktailCarousel:!1}:{cocktailPopOut:!0}:{cocktailPopOut:!1})}})))))})),(0,e.addFilter)("blocks.registerBlockType","drinks-plugin/add-cocktail-attributes",(e,t)=>"core/image"!==t?e:{...e,attributes:{...e.attributes,cocktailCarousel:{type:"boolean",default:!1},cocktailPopOut:{type:"boolean",default:!0}}}),(0,e.addFilter)("blocks.getSaveContent.extraProps","drinks-plugin/image-block-save-props",function(e,t,o){if("core/image"===t.name){let t=e.className||"",a={...e};return t=t.replace(/\bcocktail-nothing\b/g,"").replace(/\bcocktail-carousel\b/g,""),o.cocktailPopOut&&(t+=" cocktail-pop-out",a["data-wp-lightbox"]="true",a["data-wp-lightbox-group"]="drinks-plugin"),o.cocktailCarousel&&(t+=" cocktail-carousel"),a.className=t.trim(),a}return e}),(0,e.addFilter)("blocks.getBlockAttributes","drinks-plugin/ensure-attributes",function(e,t){return"core/image"===t.name?{...e,cocktailPopOut:!0===e.cocktailPopOut,cocktailCarousel:!0===e.cocktailCarousel}:e}),(0,e.addFilter)("blocks.getBlockAttributes","drinks-plugin/parse-block-attributes",function(e,t,o){if("core/image"===t.name&&o&&"string"==typeof o){const t=o.match(/data-cocktail-carousel="([^"]*)"/),a=o.match(/data-cocktail-pop-out="([^"]*)"/);t&&(e.cocktailCarousel="true"===t[1]),a&&(e.cocktailPopOut="true"===a[1])}return e}),(0,e.addFilter)("blocks.getSaveContent.extraProps","drinks-plugin/save-attributes-as-data",function(e,t,o){return"core/image"===t.name?{...e,"data-cocktail-carousel":o.cocktailCarousel?"true":"false","data-cocktail-pop-out":o.cocktailPopOut?"true":"false"}:e}),(0,e.addFilter)("editor.BlockListBlock","drinks-plugin/editor-styling",function(e){return function(t){if("core/image"===t.name){const{attributes:o}=t,a=wp.element.createElement(e,t);let l=a.props.className||"";if(l=l.replace(/\bcocktail-nothing\b/g,"").replace(/\bcocktail-carousel\b/g,""),o.cocktailCarousel&&(l+=" cocktail-carousel"),o.cocktailPopOut&&(l+=" cocktail-pop-out"),l=l.trim(),l!==a.props.className)return wp.element.cloneElement(a,{className:l})}return wp.element.createElement(e,t)}})})();