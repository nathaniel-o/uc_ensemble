(()=>{"use strict";const t=window.wp.hooks,e=window.wp.compose,o=window.wp.element,i=window.wp.blockEditor,c=window.wp.components,a=window.wp.i18n;console.log("Drinks Plugin: Block editor integration loaded"),(0,t.addFilter)("editor.BlockEdit","drinks-plugin/with-cocktail-controls",(0,e.createHigherOrderComponent)(t=>e=>{if("core/image"!==e.name)return(0,o.createElement)(t,e);const{attributes:n,setAttributes:l}=e,{cocktailPopOut:r=!0,cocktailNothing:s=!1}=n;return(0,o.createElement)(o.Fragment,{},(0,o.createElement)(t,e),(0,o.createElement)(i.InspectorControls,{},(0,o.createElement)(c.PanelBody,{title:(0,a.__)("Drinks Plugin Settings","drinks-plugin"),initialOpen:!1},(0,o.createElement)(c.PanelRow,{},(0,o.createElement)(c.ToggleControl,{label:(0,a.__)("Carousel","drinks-plugin"),help:(0,a.__)("Enable carousel functionality for this image","drinks-plugin"),checked:r,onChange:t=>{l(t?{cocktailPopOut:!0,cocktailNothing:!1}:{cocktailPopOut:!1,cocktailNothing:!0})}})),(0,o.createElement)(c.PanelRow,{},(0,o.createElement)(c.ToggleControl,{label:(0,a.__)("Pop Out","drinks-plugin"),help:(0,a.__)("Enable core lightbox functionality","drinks-plugin"),checked:s,onChange:t=>{l(t?{cocktailNothing:!0,cocktailPopOut:!1}:{cocktailNothing:!1,cocktailPopOut:!0})}})))))})),(0,t.addFilter)("blocks.registerBlockType","drinks-plugin/add-cocktail-attributes",(t,e)=>"core/image"!==e?t:{...t,attributes:{...t.attributes,cocktailPopOut:{type:"boolean",default:!0},cocktailNothing:{type:"boolean",default:!1}}}),(0,t.addFilter)("blocks.getSaveContent.extraProps","drinks-plugin/image-block-save-props",function(t,e,o){if("core/image"===e.name){let e=t.className||"",i={...t};return e=e.replace(/\bcocktail-nothing\b/g,"").replace(/\bcocktail-carousel\b/g,""),o.cocktailNothing&&(e+=" cocktail-pop-out",i["data-wp-lightbox"]="true",i["data-wp-lightbox-group"]="drinks-plugin"),o.cocktailPopOut&&(e+=" cocktail-carousel"),i.className=e.trim(),i}return t}),(0,t.addFilter)("blocks.getBlockAttributes","drinks-plugin/ensure-attributes",function(t,e){return"core/image"===e.name?{...t,cocktailNothing:!0===t.cocktailNothing,cocktailPopOut:!0===t.cocktailPopOut}:t}),(0,t.addFilter)("blocks.getBlockAttributes","drinks-plugin/parse-block-attributes",function(t,e,o){if("core/image"===e.name&&o&&"string"==typeof o){const e=o.match(/data-cocktail-pop-out="([^"]*)"/),i=o.match(/data-cocktail-nothing="([^"]*)"/);e&&(t.cocktailPopOut="true"===e[1]),i&&(t.cocktailNothing="true"===i[1])}return t}),(0,t.addFilter)("blocks.getSaveContent.extraProps","drinks-plugin/save-attributes-as-data",function(t,e,o){return"core/image"===e.name?{...t,"data-cocktail-pop-out":o.cocktailPopOut?"true":"false","data-cocktail-nothing":o.cocktailNothing?"true":"false"}:t}),(0,t.addFilter)("editor.BlockListBlock","drinks-plugin/editor-styling",function(t){return function(e){if("core/image"===e.name){const{attributes:o}=e,i=wp.element.createElement(t,e);let c=i.props.className||"";if(c=c.replace(/\bcocktail-nothing\b/g,"").replace(/\bcocktail-carousel\b/g,""),o.cocktailPopOut&&(c+=" cocktail-carousel"),o.cocktailNothing&&(c+=" cocktail-pop-out"),c=c.trim(),c!==i.props.className)return wp.element.cloneElement(i,{className:c})}return wp.element.createElement(t,e)}})})();