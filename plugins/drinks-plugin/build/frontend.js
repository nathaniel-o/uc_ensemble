(()=>{let e=null,t=!1,n=null,o=null;function i(){document.addEventListener("click",r),document.addEventListener("click",l),document.addEventListener("click",s),document.addEventListener("click",c),document.addEventListener("keydown",a),document.addEventListener("touchstart",d,{passive:!0}),h(),document.querySelectorAll('[data-cocktail-pop-out="true"]').forEach(e=>{e.style.cursor="pointer"}),document.querySelectorAll('[data-cocktail-carousel="true"]').forEach(e=>{e.style.cursor="pointer"}),new MutationObserver(e=>{e.forEach(e=>{e.addedNodes.length>0&&e.addedNodes.forEach(e=>{1===e.nodeType&&e.querySelector&&e.querySelectorAll("[data-wp-lightbox] img").forEach(e=>{const t=e.closest("[data-wp-lightbox]");t&&(t.style.cursor="pointer")})})})}).observe(document.body,{childList:!0,subtree:!0}),function(){const e=document.getElementById("drinks-carousel-overlay");if(!e)return void console.error("Drinks Plugin: Carousel overlay not found in DOM");const t=e.querySelector(".jetpack-carousel-lightbox-close");t&&t.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),f()}),e.addEventListener("click",t=>{t.target===e&&f()}),console.log("Drinks Plugin: Carousel overlay initialized")}()}function r(e){const t=e.target.closest("[data-wp-lightbox]");if(!t)return;if(t.hasAttribute("data-cocktail-pop-out")||t.hasAttribute("data-cocktail-carousel"))return;e.preventDefault(),e.stopPropagation();const n=t.querySelector("img");n&&u(n,t)}function l(e){console.log("Drinks Plugin: handleCocktailPopOutClick");const t=e.target.closest('[data-cocktail-pop-out="true"]');if(!t)return;const n=t.querySelector("img");n&&(e.preventDefault(),e.stopPropagation(),g(n,t))}function s(e){const t=e.target.closest('[data-cocktail-carousel="true"], .cocktail-carousel, [data-carousel-enabled]');if(!t)return;if("true"===t.getAttribute("data-cocktail-pop-out"))return;let n=null;n="IMG"===e.target.tagName?e.target:t.querySelector("img"),n&&(e.preventDefault(),e.stopPropagation(),m(0,t))}function c(e){console.log("Drinks Plugin: handleDrinkFilterLinkClick");const t=e.target.closest(".drink-filter-link");if(!t)return;e.preventDefault(),e.stopPropagation();const n=t.getAttribute("data-filter");if(!n)return void console.error("Drinks Plugin: No filter term found on link");const i=document.getElementById("drinks-carousel-overlay");i?(w(i,"",n,null),requestAnimationFrame(()=>{i.style.opacity="1",i.style.pointerEvents="auto",i.classList.add("active"),o=i,document.body.style.overflow="hidden"})):console.error("Drinks Plugin: Carousel overlay not found in DOM")}function a(t){e&&"Escape"===t.key&&k()}function d(t){e&&t.target===e&&k()}function u(n,o){if(t)return;const i=n.src,r=n.alt||"";let l="";const s=o.querySelector("figcaption");s&&(l=s.textContent);const c=function(e,t,n){const o=document.createElement("div");o.className="drinks-lightbox-overlay",o.innerHTML=`\n        <div class="drinks-lightbox-content">\n            <button class="drinks-lightbox-close" aria-label="Close lightbox">&times;</button>\n            <img class="drinks-lightbox-image" src="${e}" alt="${t}" />\n            ${n?`<div class="drinks-lightbox-caption">${n}</div>`:""}\n        </div>\n    `;return o.querySelector(".drinks-lightbox-close").addEventListener("click",k),o.addEventListener("click",e=>{e.target===o&&k()}),o}(i,r,l);document.body.appendChild(c),requestAnimationFrame(()=>{c.classList.add("active"),e=c,document.body.style.overflow="hidden"})}function g(e,t){let o=e.dataset.id||e.getAttribute("data-id")||"";if(!o){const t=e.className.match(/wp-image-(\d+)/);t&&(o=t[1])}e.src,e.alt;const i=function(){const e=document.createElement("div");e.className="drinks-lightbox-overlay drinks-popout-overlay",e.innerHTML='\n        <div class="drinks-lightbox-content drinks-popout-content">\n            <div class="drinks-lightbox-header drinks-popout-header">\n                <button type="button" class="drinks-lightbox-close" aria-label="Close pop-out">&times;</button>\n            </div>\n            <div class="drinks-lightbox-body drinks-popout-body">\n                <div class="drinks-content-popout" id="drinks-content-popout">\n                    <div class="drink-content-slide active" id="initial-drink-content">\n                        \x3c!-- Initial drink content will be loaded here --\x3e\n                        <div class="drink-content-loading">\n                            <div class="drink-content-loading-spinner"></div>\n                            Loading drink content...\n                        </div>\n                        \n                        \x3c!-- Navigation controls --\x3e\n                        <div class="drinks-content-navigation">\n                            <button class="drinks-content-prev" aria-label="Previous drink">&larr;</button>\n                            <button class="drinks-content-next" aria-label="Next drink">&rarr;</button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    ';const t=e.querySelector(".drinks-lightbox-close");return t&&t.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),y()}),e.addEventListener("click",t=>{t.target===e&&y()}),e}();document.body.appendChild(i),function(e,t,n){const o=e.querySelector("#drinks-content-popout");if(!o)return void console.error("Drinks Plugin: No drinks content container found");const i=o.querySelector(".drink-content-loading");i&&(i.innerHTML='<div class="drink-content-loading-spinner"></div>Loading drink content...');const r=new FormData;r.append("action","get_drink_content"),r.append("image_id",t);const l=window.drinksPluginAjax?window.drinksPluginAjax.ajaxurl:"/wp-admin/admin-ajax.php";fetch(l,{method:"POST",body:r}).then(e=>e.json()).then(t=>{const i=o.querySelector(".drink-content-loading");i&&i.remove(),t.success&&t.data?(o.innerHTML=t.data,q(n),function(e){const t=e.querySelector(".drinks-content-prev"),n=e.querySelector(".drinks-content-next");t&&t.addEventListener("click",()=>{}),n&&n.addEventListener("click",()=>{})}(e)):o.innerHTML='<div class="drink-content-error">No drink content available</div>'}).catch(e=>{console.error("Drinks Plugin: Error loading drinks content:",e);const t=o.querySelector(".drink-content-loading");t&&(t.innerHTML='<div class="drink-content-error">Error loading drink content</div>')})}(i,o,e),function(e){const t=e.querySelector(".drinks-content-popout img"),n=e.querySelector(".drinks-content-popout h1");t&&(t.style.cursor="pointer",t.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),y(),setTimeout(()=>{p()},100)})),n&&(n.style.cursor="pointer",n.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),y(),setTimeout(()=>{p()},100)}))}(i),requestAnimationFrame(()=>{i.classList.add("active"),n=i,document.body.style.overflow="hidden"})}function p(e,t){n&&y();const i=document.getElementById("drinks-carousel-overlay");i?(w(i,"","",null),requestAnimationFrame(()=>{i.style.opacity="1",i.style.pointerEvents="auto",i.classList.add("active"),o=i,document.body.style.overflow="hidden"})):console.error("Drinks Plugin: Carousel overlay not found in DOM")}function m(e,t){console.log("Drinks Plugin: openCocktailCarousel"),n&&y();const i=document.getElementById("drinks-carousel-overlay");i?(w(i,"","",t),requestAnimationFrame(()=>{i.style.opacity="1",i.style.pointerEvents="auto",i.classList.add("active"),o=i,document.body.style.overflow="hidden"})):console.error("Drinks Plugin: Carousel overlay not found in DOM")}function k(){e&&!t&&(t=!0,e.classList.remove("active"),document.body.style.overflow="",setTimeout(()=>{e&&e.parentNode&&e.parentNode.removeChild(e),e=null,t=!1},300))}function y(){n&&(n.classList.remove("active"),document.body.style.overflow="",setTimeout(()=>{n&&n.parentNode&&n.parentNode.removeChild(n),n=null},300))}function h(){document.querySelectorAll("[data-wp-lightbox] img").forEach(e=>{const t=e.closest("[data-wp-lightbox]");t&&(t.style.cursor="pointer")})}function v(){const e=document.querySelectorAll('[data-cocktail-pop-out="true"]');return e.length,{containers:e.length,lightbox:!!n,global:!!window.drinksPluginPopOut}}function f(){let e=o;e||(e=document.querySelector(".jetpack-carousel-lightbox-overlay.active")),e&&(e.classList.remove("active"),document.body.style.overflow="",setTimeout(()=>{if(e){e.style.opacity="0",e.style.pointerEvents="none";const t=e.querySelector("#jetpack-carousel-slides");t&&(t.innerHTML="")}o=null},300))}function w(e,t="",n="",o=null){console.log("Drinks Plugin: loadCarouselImages"),console.log("loadCarouselImages for filter term: "+n+" and match term: "+t);const i=e.querySelector("#jetpack-carousel-slides");if(!i)return void console.error("Drinks Plugin: No slides container found");if(!t&&o){const e=o.querySelector("figcaption");t=e?e.textContent.trim():""}i.innerHTML='<li class="wp-block-jetpack-slideshow_slide swiper-slide"><div class="jetpack-carousel-loading"><div class="jetpack-carousel-loading-spinner"></div>Loading carousel images...</div></li>';const r=new FormData;r.append("action","drinks_filter_carousel"),r.append("search_term",n),r.append("figcaption_text",t);const l=window.drinksPluginAjax?window.drinksPluginAjax.ajaxurl:"/wp-admin/admin-ajax.php";fetch(l,{method:"POST",body:r}).then(e=>e.text()).then(t=>{const r=document.createElement("div");r.innerHTML=t;const l=r.querySelector(".drinks-search-results-header");if(l){const t=e.querySelector(".jetpack-carousel-lightbox-header");if(t){const e=t.querySelector(".drinks-search-results-header");e&&e.remove(),t.insertBefore(l.cloneNode(!0),t.firstChild)}}const s=r.querySelectorAll("li");if(console.log("Drinks Plugin (loadCarouselImages): Found",s.length,"new slides in AJAX response"),0===s.length)return void(n?(i.innerHTML='<li class="wp-block-jetpack-slideshow_slide swiper-slide"><div class="jetpack-carousel-loading">No drinks found. Redirecting to search page...</div></li>',setTimeout(()=>{f(),window.location.href="/?s="+encodeURIComponent(n)},1500)):i.innerHTML='<li class="wp-block-jetpack-slideshow_slide swiper-slide"><div class="jetpack-carousel-loading">No drinks found</div></li>');if(s.length>0){const e=s[0].querySelector("img");e&&(console.log("Drinks Plugin (frontend.js): First slide image ID:",e.getAttribute("data-id")),console.log("Drinks Plugin (frontend.js): First slide image alt:",e.getAttribute("alt")))}const c=e.querySelector(".wp-block-jetpack-slideshow_container"),a=c?.swiper;a?(console.log("Drinks Plugin: Removing all existing Swiper slides"),a.removeAllSlides()):i.innerHTML="",s.forEach((e,t)=>{console.log("Drinks Plugin (frontend.js): Adding slide",t),i.appendChild(e.cloneNode(!0))}),console.log("Drinks Plugin: Total slides in DOM:",i.children.length),console.log("Drinks Plugin: Slides container HTML length:",i.innerHTML.length),q(o?.querySelector("img")||document.querySelector("img")),function(e){const t=e.querySelector(".wp-block-jetpack-slideshow_container"),n=e.querySelector("#jetpack-carousel-slides");if(console.log("Drinks Plugin: initializeJetpackSlideshow - slides in wrapper:",n?.children.length),t&&t.swiper){const e=t.swiper;console.log("Drinks Plugin: Current Swiper slides count:",e.slides.length),e.params.loop&&e.loopDestroy(),e.update(),console.log("Drinks Plugin: After update - Swiper slides count:",e.slides.length),e.slides.length>1&&(e.params.loop=!0,e.loopCreate(),e.update()),e.updateSize(),e.updateSlides(),e.updateProgress(),e.updateSlidesClasses();const o=e.params.loop?1:0;e.slideTo(o,0),requestAnimationFrame(()=>{e.update()}),console.log("Drinks Plugin: Swiper updated successfully, moved to slide:",o),console.log("Drinks Plugin: Final slides in DOM:",n?.children.length),console.log("Drinks Plugin: Active slide index:",e.activeIndex),console.log("Drinks Plugin: Swiper width:",e.width,"height:",e.height)}else console.error("Drinks Plugin: Swiper instance not found - Jetpack may not have initialized")}(e)}).catch(e=>{if(console.error("Drinks Plugin: Error loading carousel images:",e),n){const e=i.querySelector(".jetpack-carousel-loading");e&&(e.innerHTML='<div class="jetpack-carousel-loading">Error loading drinks. Redirecting to search page...</div>'),setTimeout(()=>{f(),window.location.href="/?s="+encodeURIComponent(n)},1500)}else{const e=i.querySelector(".jetpack-carousel-loading");e&&(e.innerHTML='<div class="jetpack-carousel-loading">Error loading carousel images</div>')}})}function b(e,t){let n;if(t||(t=".entry-content"),"string"==typeof t)n=document.querySelector(t);else{if(!(t instanceof HTMLElement))return;n=t}n&&n.querySelectorAll("img").forEach(t=>{const n=S(t);let o=e;n&&(o=L(n)),o.includes("springtime")&&(o="summertime");const i=`var(--${o}-border)`,r=`var(--${o}-font-color)`,l=`var(--${o}-shadow)`;t.style.border=i;const s=t.closest("figure");if(s){const e=s.querySelector("figcaption");e&&(e.style.color=r,e.style.textShadow=l)}})}function S(e){let t=(e.title||e.alt||"").match(/_([A-Z]{2})/);return t?t[1]:(t=(e.src||"").match(/_([A-Z]{2})/),t?t[1]:null)}function L(e){return{AU:"autumnal",RO:"romantic",EV:"everyday",SU:"summertime",SP:"summertime",FP:"fireplace",SO:"special-occasion",WI:"winter"}[e]||"std"}function q(e){e.closest('[data-cocktail-pop-out="true"]')&&setTimeout(()=>{const t=document.querySelector(".drinks-content-popout img");if(t){const e=S(t);if(e){const t=L(e);b(t,".drinks-content-popout");const n=document.querySelector(".drinks-content-popout");if(n){const e=n.querySelector("h1");e&&(e.style.color="#241547",e.style.textShadow="none"),n.querySelectorAll("li").forEach((e,n)=>{e.style.color=`var(--${t}-accent-color)`,e.style.textShadow=`var(--${t}-shadow)`,e.querySelectorAll("em").forEach((e,t)=>{e.style.color="black",e.style.fontWeight="bold",e.style.fontStyle="normal",e.style.marginRight="0.25em",e.style.textShadow="none"})})}}}else{const t=S(e);if(t){const e=L(t);b(e,".drinks-content-popout");const n=document.querySelector(".drinks-content-popout");if(n){const t=n.querySelector("h1");t&&(t.style.color="#241547",t.style.textShadow="none"),n.querySelectorAll("li").forEach((t,n)=>{t.style.color=`var(--${e}-accent-color)`,t.style.textShadow=`var(--${e}-shadow)`,t.querySelectorAll("em").forEach((e,t)=>{e.style.color="black",e.style.fontWeight="bold",e.style.fontStyle="normal",e.style.marginRight="0.25em",e.style.textShadow="none"})})}}}},100);const t=document.querySelector(".jetpack-carousel-lightbox-overlay.active");t&&t.querySelectorAll(".wp-block-jetpack-slideshow_slide").forEach((e,t)=>{const n=e.querySelector("img");if(n){const t=S(n);t&&b(L(t),e)}})}function E(e){if(!e||"IMG"!==e.tagName)return void console.warn("⚠️ ucPortraitLandscape: Invalid image element:",e);const t=e.closest("figure")||e.closest(".wp-block-image")||e.parentElement;function n(){e.naturalWidth&&e.naturalHeight&&(t.classList.contains("portrait"),t.classList.contains("landscape"),t.classList.remove("portrait","landscape"),e.naturalHeight>e.naturalWidth?t.classList.add("portrait"):e.naturalHeight<e.naturalWidth&&t.classList.add("landscape"))}t?t.classList.contains("pop-off")||t.classList.contains("wp-block-gallery")||t.classList.contains("portrait")||t.classList.contains("landscape")||(e.complete&&e.naturalWidth&&e.naturalHeight?n():e.addEventListener("load",()=>{n()},{once:!0})):console.warn("⚠️ ucPortraitLandscape: No container found for image:",e.src)}function P(){document.querySelectorAll(".wp-block-image img, figure img").forEach((e,t)=>{E(e)});new MutationObserver(e=>{e.forEach(e=>{e.addedNodes.length>0&&e.addedNodes.forEach(e=>{if(1===e.nodeType){"IMG"===e.tagName&&E(e);const t=e.querySelectorAll?e.querySelectorAll("img"):[];t.length>0&&t.forEach((e,t)=>{E(e)})}})})}).observe(document.body,{childList:!0,subtree:!0})}window.drinksPluginLightbox={init:i,open:u,close:k,setup:h},window.drinksPluginPopOut={init:i,open:g,close:y,test:v},window.drinksPluginCarousel={loadImages:w,close:f,open:m},window.testDrinksContent=v,window.drinksPluginStyling={styleImagesByPageID:b,extractCategoryFromImage:S,mapCategoryCodeToVariable:L,ucStyleLightBoxesByPageID:q},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",i):i(),document.addEventListener("keydown",e=>{"Escape"===e.key&&(k(),y(),f())}),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",P):P(),window.addEventListener("load",()=>{document.querySelectorAll(".wp-block-image img, figure img").forEach((e,t)=>{E(e)})})})();