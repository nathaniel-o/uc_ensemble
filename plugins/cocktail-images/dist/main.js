(()=>{var e={725:()=>{!function(){"use strict";console.log("Cocktail Images Block Editor script loaded"),wp.domReady(function(){if(console.log("Cocktail Images: DOM Ready"),!(wp.hooks&&wp.compose&&wp.element&&wp.blockEditor&&wp.components&&wp.i18n))return void console.error("Cocktail Images: Required WordPress components not available");const{addFilter:e}=wp.hooks,{createHigherOrderComponent:t}=wp.compose,{Fragment:a}=wp.element,{InspectorControls:o}=wp.blockEditor,{PanelBody:i,PanelRow:n,ToggleControl:c}=wp.components,{__:r}=wp.i18n;e("blocks.registerBlockType","cocktail-images/image-block-attributes",function(e,t){return"core/image"===t?{...e,attributes:{...e.attributes,cocktailNothing:{type:"boolean",default:!1},cocktailPopOut:{type:"boolean",default:!1}}}:e}),e("editor.BlockEdit","cocktail-images/with-cocktail-image-controls",t(function(e){return function(t){if("core/image"!==t.name)return wp.element.createElement(e,t);const{attributes:s,setAttributes:l}=t,{cocktailNothing:d,cocktailPopOut:m}=s;return wp.element.createElement(a,{},wp.element.createElement(e,t),wp.element.createElement(o,{},wp.element.createElement(i,{title:r("Cocktail Images","cocktail-images"),initialOpen:!1},wp.element.createElement(n,{},wp.element.createElement(c,{label:r("Nothing","cocktail-images"),help:r("This button does nothing","cocktail-images"),checked:d,onChange:function(e){l({cocktailNothing:e})}})),wp.element.createElement(n,{},wp.element.createElement(c,{label:r("Pop Out","cocktail-images"),help:r("Enable pop out effect for this image","cocktail-images"),checked:m,onChange:function(e){l({cocktailPopOut:e})}})))))}},"withCocktailImageControls")),e("blocks.getSaveContent.extraProps","cocktail-images/image-block-save-props",function(e,t,a){if("core/image"===t.name){let t=e.className||"";return a.cocktailPopOut&&(t+=" cocktail-pop-out"),{...e,className:t.trim()}}return e}),console.log("Cocktail Images Block Editor integration loaded"),console.log("Cocktail Images: Filters registered successfully")})}()},935:()=>{!function(){"use strict";function e(e){e.preventDefault();const t=e.target;if("IMG"!==t.tagName)return;const a=t.closest("figure.wp-block-image");if(!a)return;const o=t.getAttribute("data-id")||t.getAttribute("data-attachment-id"),i=t.getAttribute("alt")||"";console.log("Randomizing image:",o,i);const n=cocktailImagesAjax.ajaxurl,c=`action=randomize_image&current_id=${encodeURIComponent(o)}&nonce=${cocktailImagesAjax.nonce}`;fetch(n,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:c}).then(e=>e.json()).then(e=>{if(e.success&&e.data.image){const o=e.data.image;console.log("Image randomized to:",o.title),console.log("New image URL:",o.src),t.src=o.src,t.alt=o.alt,t.setAttribute("data-id",o.id),o.attachment_id&&t.setAttribute("data-attachment-id",o.attachment_id),o.srcset&&t.setAttribute("srcset",o.srcset),o.sizes&&t.setAttribute("sizes",o.sizes),o.data_orig_file&&t.setAttribute("data-orig-file",o.data_orig_file),o.data_orig_size&&t.setAttribute("data-orig-size",o.data_orig_size),o.data_image_title&&t.setAttribute("data-image-title",o.data_image_title),o.data_image_caption&&t.setAttribute("data-image-caption",o.data_image_caption),o.data_medium_file&&t.setAttribute("data-medium-file",o.data_medium_file),o.data_large_file&&t.setAttribute("data-large-file",o.data_large_file),o.attachment_id&&(t.className=t.className.replace(/wp-image-\d+/,`wp-image-${o.attachment_id}`));const i=a.querySelector("figcaption");i&&o.data_image_caption&&(i.innerHTML=o.data_image_caption,console.log("Updated figcaption:",o.data_image_caption)),t.onload=function(){console.log("New image loaded successfully"),"function"==typeof ucPortraitLandscape&&ucPortraitLandscape(t,a)},setTimeout(()=>{t.complete&&(console.log("Image load completed"),"function"==typeof ucPortraitLandscape&&ucPortraitLandscape(t,a))},100)}else console.error("Failed to randomize image:",e.message)}).catch(e=>{console.error("Error randomizing image:",e)})}function t(e){const t=e.className.split(" ").find(e=>e.startsWith("wp-image-"));if(t&&t.replace("wp-image-","")){const t=e.alt||e.getAttribute("data-image-title")||e.src.split("/").pop().replace(/\.[^/.]+$/,""),a={action:"check_featured_image",nonce:cocktailImagesAjax.nonce,image_title:t};return fetch(cocktailImagesAjax.ajaxurl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(a)}).then(e=>{if(!e.ok)return e.text().then(t=>{throw console.error("Server response:",t),new Error(`HTTP error! status: ${e.status} - Server returned: ${t.substring(0,200)}`)});const t=e.headers.get("content-type");return t&&t.includes("application/json")?e.json():e.text().then(e=>{throw console.error("Non-JSON response:",e),new Error("Response is not JSON")})}).then(e=>{if(e.success){const t=e.data;return!!t.post_id&&(t.exact_match?t.other_matches&&t.other_matches.length:t.all_matches&&t.all_matches.length,t.post_id)}return!1}).catch(e=>(console.error("Error checking featured image status:",e),!1))}return Promise.resolve(!1)}function a(e){e.preventDefault();const t=e.target;if("IMG"!==t.tagName)return;const a=t.closest("figure.wp-block-image");if(!a)return;const i=t.getAttribute("data-id")||t.getAttribute("data-attachment-id"),n=t.getAttribute("alt")||"",c=t.getAttribute("data-image-title")||"",r=`queue_${i}`;let s=window[r]||{currentIndex:0,totalMatches:0,baseTitle:"",matches:[]},l=c||n;if(l=l.split(":")[0].toLowerCase().replace(/^T2-/,"").replace(/[-_]/g," ").replace(/\s+/g," ").trim().split(" ").filter(e=>e.length>=3).join(" "),console.log("Base Title: ",l),s.baseTitle!==l||0===s.matches.length){s={currentIndex:0,totalMatches:0,baseTitle:l,matches:[]},console.log(`Searching for matches: "${l}"`);const e=cocktailImagesAjax.ajaxurl,n=`action=find_matching_image&current_id=${encodeURIComponent(i)}&base_title=${encodeURIComponent(l)}&is_new_search=true&nonce=${cocktailImagesAjax.nonce}`;fetch(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:n}).then(e=>e.json()).then(e=>{e.success&&e.data.all_matches?(s.matches=e.data.all_matches,s.totalMatches=e.data.total_matches,window[r]=s,console.log(`Found ${s.totalMatches} matches, cached for future use`),o(t,a,s,r)):console.error("Failed to find matches:",e.message)}).catch(e=>{console.error("Error finding matches:",e)})}else console.log(`Using cached matches: "${l}" (index: ${s.currentIndex}/${s.totalMatches})`),o(t,a,s,r)}function o(e,t,a,o){if(0===a.matches.length)return void console.error("No cached matches available");const n=a.currentIndex%a.totalMatches,c=a.matches[n];a.currentIndex=(n+1)%a.totalMatches,window[o]=a,console.log(`Match ${n+1}/${a.totalMatches}: "${c.title}"`);const r=function(e){const t=document.createElement("div");return t.style.cssText="\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background: white;\n            z-index: 10;\n            opacity: 0;\n            transition: opacity 0.3s ease-in-out;\n        ",e.style.position="relative",e.appendChild(t),setTimeout(()=>{t.style.opacity="1"},10),t}(t);setTimeout(()=>{e.src=c.src,e.alt=c.alt,e.setAttribute("data-id",c.id),c.attachment_id&&e.setAttribute("data-attachment-id",c.attachment_id),c.srcset&&e.setAttribute("srcset",c.srcset),c.sizes&&e.setAttribute("sizes",c.sizes),c.data_orig_file&&e.setAttribute("data-orig-file",c.data_orig_file),c.data_orig_size&&e.setAttribute("data-orig-size",c.data_orig_size),c.data_image_title&&e.setAttribute("data-image-title",c.data_image_title),c.data_image_caption&&e.setAttribute("data-image-caption",c.data_image_caption),c.data_medium_file&&e.setAttribute("data-medium-file",c.data_medium_file),c.data_large_file&&e.setAttribute("data-large-file",c.data_large_file),c.attachment_id&&(e.className=e.className.replace(/wp-image-\d+/,`wp-image-${c.attachment_id}`));const a=t.querySelector("figcaption");if(a){a.getAttribute("data-original-caption")||a.setAttribute("data-original-caption",a.innerHTML);const e=a.getAttribute("data-original-caption"),t=c.data_image_caption||c.title;a.innerHTML=e+`<p style="font-size: 12px; margin: 5px 0 0 0; color: #666; font-style: italic;">(${t})</p>`,console.log("Updated figcaption with original + new title:",t)}e.onload=function(){console.log("New image loaded successfully"),i(r),"function"==typeof ucPortraitLandscape&&ucPortraitLandscape(e,t)},setTimeout(()=>{e.complete&&(console.log("Image load completed"),i(r),"function"==typeof ucPortraitLandscape&&ucPortraitLandscape(e,t))},100)},1e3)}function i(e){e.style.opacity="0",setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},300)}function n(){const e=document.querySelectorAll("figure.wp-block-image img");e.forEach(e=>{const t=35e3*Math.random()+5e3;console.log(`Setting up auto-title-matching for image in ${Math.round(t/1e3)}s`),setTimeout(()=>{a({target:e,preventDefault:()=>{}});const t=()=>{const o=35e3*Math.random()+5e3;console.log(`Next auto-title-matching in ${Math.round(o/1e3)}s`),setTimeout(()=>{a({target:e,preventDefault:()=>{}}),t()},o)};t()},t)}),console.log(`Setup auto-title-matching for ${e.length} image blocks`)}document.addEventListener("DOMContentLoaded",function(){window.location.href.includes("upload.php")||n()}),window.ucRandomizeImage=e,window.ucSetupImageRandomization=function(){const t=document.querySelectorAll("figure.wp-block-image img");t.forEach(t=>{const a=8e4*Math.random()+1e4;setTimeout(()=>{e({target:t,preventDefault:()=>{}});const a=()=>{const o=8e4*Math.random()+1e4;console.log(`Next auto-randomization in ${Math.round(o/1e3)}s`),setTimeout(()=>{e({target:t,preventDefault:()=>{}}),a()},o)};a()},a)}),console.log(`Setup auto-randomization for ${t.length} image blocks`)},window.ucOneDrinkAllImages=a,window.ucSetupOneDrinkAllImages=n,window.ucOneTimePostsTest=function(){if(console.log("=== Starting ucOneTimePostsTest ==="),!window.location.href.includes("upload.php"))return void console.log("Not on media library page. Navigate to /wp-admin/upload.php to run this test.");const e=document.querySelectorAll(".attachment-preview img, .attachment img, .wp-attachment img");if(0===e.length)return void console.log("No images found in media library. Make sure you have images loaded.");console.log(`Found ${e.length} images in media library`);let a=0;!function o(i){const n=Math.min(i+5,e.length);for(let o=i;o<n;o++){const i=e[o],n=i.src,c=i.alt||"No alt text";console.log(`\n--- Testing Image ${o+1}/${e.length} ---`),console.log(`Src: ${n}`),console.log(`Alt: ${c}`),t(i).then(e=>{e?console.log(`✅ Image ${o+1}: Featured in post ID ${e}`):console.log(`❌ Image ${o+1}: Not featured in any post`)}).catch(e=>{console.error(`❌ Image ${o+1}: Error - ${e.message}`)}),a++}n<e.length?setTimeout(()=>{o(n)},1e3):(console.log("\n=== Test Complete ==="),console.log(`Processed ${a} images total`))}(0)}}()}},t={};function a(o){var i=t[o];if(void 0!==i)return i.exports;var n=t[o]={exports:{}};return e[o](n,n.exports,a),n.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var o in t)a.o(t,o)&&!a.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";a(935),a(725),console.log("Cocktail Images Plugin loaded")})()})();